<!DOCTYPE html>
<html>
	<head>
    <title>OldPhoneDeals</title>
		<link rel="stylesheet"href="css/checkout.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
	</head>
    <body>
        <header>
            <div id="navBarMenu">
                <div id="navBarTitle">
                    OldPhoneDeals
                </div>
                <nav>
                    <ul id="navBarLinks">
                        <li><a href="/">Home</a></li>
                        <li><a>Checkout</a></li>
                        <% if (!loggedIn) { %>
                            <li><a href="#">Sign In</a></li>
                        <% } else { %>
                            <li><a href="#">Profile</a></li>
                            <li><a href="#">Sign Out</a></li>
                        <% } %>
                    </ul>
                </nav>
            </div>
            <div id="navBarSearchItems">
                <div id="navBarSearchStateItems">
                    <% if (state == "search") { %>
                    <div id="searchBrandFilterContainer">
                        <select id="searchBrandFilter">
                        </select>
                    </div>

                    <!-- TODO change the max to highest price and add value = max -->
                    <div id="searchPriceFilterContainer">
                        $min
                        <input id="searchPriceFilter" type="range" min="0" max="100">
                        $value
                    </div>
                    <% } %>
                </div>
                <div id="navBarSearchBar">
                    <input id="searchBar" type="search">
                    <button id="navBarSearchBtn">Search</button>
                </div>
            </div>
        </header>
        <div id="checkoutContent">
            <h2> Checkout </h2>
            <% var total = 0; %>
            <% for(var i=0; i < cart.length; i++) { %>
                <div class="product-box" id="<%= i %>">
                    <% total += (cart[i].phone.price * cart[i].quantity) %>
                    <p><%= cart[i].phone.title.substring(0,74) %>
                        <% if(cart[i].phone.title.length > 75) {%> 
                            ... 
                        <% }%></p>
                    <p> $<%= cart[i].phone.price %></p>
                    <span class="itemCartQuantity" title="<%= cart[i].phone.title %>"  seller="<%= cart[i].phone.seller %>"><%= cart[i].quantity %></span>
                    <div>
                        <button class="quantity" id="<%= i %>">Change quantity</button>
                        <button class="quantity" id="<%= i %>">Remove</button>
                    </div>
                </div>    
            <% } %>
            <% if(cart.length > 0) {%>
            <div class="footer">
                <label>Total price: $<%= total %></label>
                <button>Confirm</button>
                <button class="back-button">Back</button>
            </div>
            <% } else{ %>
                <h2>Nothing in cart</h2>
            <% } %>
        </div>
        </div>
        <script>
            var state = "<%= state %>";
            var cart = <%- JSON.stringify(cart) %>;
        </script>
        <script src="js/main.js"></script>
        <script src="js/search.js"></script>
        <script src="js/checkout.js"></script>
    </body>
</html>